<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="x-ua-compatible" content="chrome=1 , IE=edge" />
	<meta http-equiv="Content-Language" content="zh-cn" />
	<title>接口生成中心</title>	
	<script src="js\jquery-2.1.4.min.js"></script>
	<script src="js\bootstrap.min.js" type="text/javascript"></script>
	<!--<script src="http://misc.apiplus.cn/js/extend.js" type="text/javascript"></script>-->
	<link href="css\bootstrap.min.css" rel="stylesheet" type="text/css" />
	<link href="css\bootstrap-theme.min.css" rel="stylesheet" type="text/css" />
	<style type="text/css">
		html {height:100%;}
		body { font-size:16px; color:rgb(46,133,188); font-family:"微软雅黑","Microsoft Yahei", Verdana, Tahoma, Arial, "宋体",
			sans-serif;margin:0px;padding:0px;min-width:768px}
		/**.focus {outline:0 none}
		* {padding:0px;margin:0px;}
		input,button,a { outline:0 none !important; blr:expression(this.onFocus=this.blur()); } 
		div, img, ol, ul, li, dl, dt, dd, h1, h2, h3, h4, h5, table, tr, th, td,select {border:none;list-style-type:none;margin:0;padding:0;font-weight:normal;font-size:14px;color:#333}*/
		form {margin:0;padding:0;}
		input { vertical-align:middle;border:none;}
		a {text-decoration:none;cursor:pointer;color:#5d5d5d;-webkit-transition: all .5s;-o-transition: all .5s;transition: all .5s;outline:none;blr:expression(this.onFocus=this.blur());}
		a:focus { -moz-outline-style: none; text-decoration: none;} 
		a:hover {text-decoration: none;}
		.container {padding-top:0px; width:99%;height:100%}
		.glyphicon {margin-right:5px;}
		.red .glyphicon {margin-right:10px;}
		.red { color:#A33}
		.rInfos .row{line-height:25px; margin-top:6px;}
		.rRules .row{line-height:25px; margin-top:6px;}
		.uLinks .row .input-group {margin-top:6px;}
		.fl {float:left;}
		.font-sm{font-size:10px;}
		.bold {font-weight:bold}
		.sName{font-weight:bold}

		.section {font-weight:bold;margin-top:30px;}
		.line {height:1px; line-height:1px; font-size:0px; background-color:#aaa;margin:15px 0px 15px 0px}
		.btn .label {margin-left:5px; font-weight:normal}
		.sCopyAll {background-color:#EC9A24}
		.sCopyAll a{color:#fff}
		.sCopyAll a:hover{color:#333}
		.sLink {background-color:#5cb85c}
		.sLink a{color:#fff}
		.sLink a:hover{color:#333}
	</style>	
</head>
<body style="margin:10px;overflow-x:hidden;font-family:微软雅黑,黑体;color:rgb(46,133,188);">
	<table border="0px;" width="100%">
		<tr>
			<td style="font-size:25px;font-family:微软雅黑,黑体;color:white;background-image: linear-gradient(to right,rgb(46,133,188) 0,white 80%);">&nbsp;接口调用管理</td>
		</tr>
	</table>	
<div class="container">
	<h4 class="section" style="border-style: solid none double none;border-width:2px">账号信息</h4>
	<div class="rInfos" style="padding:10 10 10 10">
		<div class="row">
			<div class="col-xs-2" style="text-align:right"><span class="glyphicon glyphicon-tags"></span>单位名称：</div>
			<div class="col-xs-4"><input type="text" class="form-control" placeholder="请输入单位名称"></div>
			<div class="col-xs-2" style="text-align:right"><span class="glyphicon glyphicon-credit-card"></span>单&nbsp;位&nbsp;I&nbsp;D：</div>
			<div class="col-xs-4"><input type="text" class="form-control" placeholder="请输入单位ID"></div>
		</div>
		<div class="row">
			<div class="col-xs-2" style="text-align:right"><span class="glyphicon glyphicon-user"></span>&nbsp;联&nbsp;系&nbsp;人：</div>
			<div class="col-xs-4"><input type="text" class="form-control" placeholder="请输入对方联系人"></div>
			<div class="col-xs-2" style="text-align:right"><span class="glyphicon glyphicon-earphone"></span>联系电话：</div>
			<div class="col-xs-4"><input type="text" class="form-control" placeholder="请输入联系电话"></div>
		</div>
		<div class="row">
			<div class="col-xs-2" style="text-align:right"><h4 class="bold"><span class="glyphicon glyphicon-th-large"></span>TOKEN:</h3></div>
			<div class="col-xs-7"><h4 class="bold">9E485D045EAB4050</h3></div>
			<div class="col-xs-3"><button type="button" class="btn btn-primary">生成TOKEN</button>&nbsp;&nbsp;<button type="button" class="btn">复制TOKEN</button></div>
		</div>		
		<div class="row sr-only">
			<div class="col-xs-2"><span class="glyphicon glyphicon-envelope"></span>IP白名单：</div>
			<div class="col-xs-10" style='font-weight:700;color:#3d6f8b'></div>
		</div>
		<div class="row sr-only">
			<div class="col-xs-2"><span class="glyphicon glyphicon-tag"></span>副Token：</div>
			<div class="col-xs-10 bold" style="margin:0px;padding:0px;"></div>
		</div>
	</div>
	<h4 class="section"" style="border-style: solid none double none;border-width:2px">接口服务器</h4>
	<div class="rInfos">
		<div class="row">
			<div class="col-xs-2"><span class="glyphicon glyphicon-tag"></span>账号绑定IP：</div>
			<div class="col-xs-10 bold" style="margin:0px;padding:0px">
				<div class="col-xs-4 fl"><span style="color:#f00" title="120.26.124.144">120.26.124.144 (接口A)</span></div>
				<div class="col-xs-4 fl"><span style="color:#f00" title="121.40.89.67">121.40.89.67 (接口B)</span></div>
			</div>
		</div>
		<div class="row">
			<div class="col-xs-12">
				<ul>
				<li>接口服务器(集群)说明：</li>
				<li><span style='font-weight:700'>正式接口服务器 </span>分为Ａ,Ｂ二组，每组由９台单服务器(4核8G)支撑负载均衡。SLB响应带宽为2组 × 60M</li>
												<li>Ａ,Ｂ二组服务器集群的配置完全相同，请根据自身情况选择其一作为采集服务器</li>
				<li>为保正服务器的稳定性，以避免IP占用或网络攻击，请勿将接口地址告知不相干人员</li>
				<li>这里仅显示公用服务器地址，已开通独立服务器的用户请选择手动输入为你的专用IP</li>
								</ul>
			</div>
		</div>
	</div>

	<h4 class="section"" style="border-style: solid none double none;border-width:2px">接口生成</h4>
	<div class="rRules">
		<div class="row" id="ihost">
			<div class="col-xs-2">接口地址：</div>
			<div class="col-xs-10">
				<div class="btn-group btn-group-justified">
					<div class="btn-group"><button type="button" class="btn btn-default" val="120.26.124.144" title="120.26.124.144">120.26.124.144<span class="label label-success">接口A</span></button></div>
					<div class="btn-group"><button type="button" class="btn btn-primary" val="121.40.89.67" title="121.40.89.67">121.40.89.67<span class="label label-success">接口B</span></button></div>
					<div class="btn-group"><button type="button" class="btn btn-default" val="">手工输入<span class="label label-success">VIP</span></button></div>
					<div class="btn-group btn-group-addition"><input type="text" class="form-control" placeholder="专用IP地址" value="" /></div>
				</div>
			</div>
		</div>
		<div class="row" id="iface">
			<div class="col-xs-2">接口格式：</div>
			<div class="col-xs-10">
				<div class="btn-group btn-group-justified">
					<div class="btn-group"><button type="button" class="btn btn-primary" val="newlys">按最新查询<span class="label label-success">默认</span></button></div>					
					<div class="btn-group"><button type="button" class="btn btn-default" val="newlyb" title="不选择接口时默认返回所有接口数据">按最新批量查询(<span class="color:#f00">新</span>)</button></div>					<div class="btn-group"><button type="button" class="btn btn-default" val="daily">按日期查询</button></div>
					<div class="btn-group"><button type="button" class="btn btn-default" val="curlys">按状态查询</button></div>
					<div class="btn-group"><button type="button" class="btn btn-default" val="curlyb" title="不选择接口时默认返回所有接口数据">按状态批量查询(<span class="color:#f00">新</span>)</button></div>					<!--<div class="btn-group"><button type="button" class="btn btn-default" val="phase">按期号查询</button></div>-->
				</div>
			</div>
		</div>
		<div class="row" id="icodes" style="display:none">
			<div class="col-xs-2">接口选择：</div>
			<div class="col-xs-10">
				<div class="btn-group btn-group-justified">
				<div class="btn-group"><button type="button" class="btn btn-default" val="gd11x5">景区数据接口</button></div>
				<div class="btn-group"><button type="button" class="btn btn-default" val="jx11x5">酒店数据接口</button></div>
				<div class="btn-group"><button type="button" class="btn btn-default" val="sd11x5">旅行社数据接口</button></div>
				<div class="btn-group"><button type="button" class="btn btn-default" val="sh11x5">导游数据接口</button></div>
				<div class="btn-group"><button type="button" class="btn btn-default" val="sh11x5">领队数据接口</button></div>
				<div class="btn-group"><button type="button" class="btn btn-default" val="sh11x5">商品数据接口</button></div>
				<div class="btn-group"><button type="button" class="btn btn-default" val="sh11x5">设施数据接口</button></div>
				<div class="btn-group"><button type="button" class="btn btn-default" val="sh11x5">交通数据接口</button></div>
				</div>
			</div>
		</div>
		<div class="row" id="irewrite">
			<div class="col-xs-2">参数方式：</div>
			<div class="col-xs-10">
				<div class="btn-group btn-group-justified">
					<div class="btn-group"><button type="button" class="btn btn-primary" val="args">动态参数<span class="label label-success">默认</span></button></div>
					<div class="btn-group"><button type="button" class="btn btn-default" val="file">静态参数</button></div>
				</div>
			</div>
		</div>
		<div class="row" id="iformat">
			<div class="col-xs-2">数据格式：</div>
			<div class="col-xs-10">
				<div class="btn-group btn-group-justified">
					<div class="btn-group"><button type="button" class="btn btn-primary" val="xml">XML格式<span class="label label-success">默认</span></button></div>
					<div class="btn-group"><button type="button" class="btn btn-default" val="json">JSON格式</button></div>
				</div>
			</div>
		</div>
		<div class="row" id="irows">
			<div class="col-xs-2">返回行数：</div>
			<div class="col-xs-10">
				<div class="btn-group btn-group-justified">
					<div class="btn-group"><button type="button" class="btn btn-default" val="1">1</button></div>
					<div class="btn-group"><button type="button" class="btn btn-default" val="2">2</button></div>
					<div class="btn-group"><button type="button" class="btn btn-default" val="3">3</button></div>
					<div class="btn-group"><button type="button" class="btn btn-default" val="4">4</button></div>
					<div class="btn-group"><button type="button" class="btn btn-primary" val="5">5<span class="label label-success">默</span></button></div>
					<div class="btn-group obr"><button type="button" class="btn btn-default" val="6">6</button></div>
					<div class="btn-group obr"><button type="button" class="btn btn-default" val="7">7</button></div>
					<div class="btn-group obr"><button type="button" class="btn btn-default" val="8">8</button></div>
					<div class="btn-group obr"><button type="button" class="btn btn-default" val="9">9</button></div>
					<div class="btn-group obr"><button type="button" class="btn btn-default" val="10">10</button></div>
					<div class="btn-group obr"><button type="button" class="btn btn-default" val="12">12</button></div>
					<div class="btn-group obr"><button type="button" class="btn btn-default" val="15">15</button></div>
					<div class="btn-group obr"><button type="button" class="btn btn-default" val="20">20</button></div>
				</div>
			</div>
		</div>
	</div>
	<h4 class="section"" style="border-style: solid none double none;border-width:2px">接口列表(4种)</h4>	
	<div class="uLinks">
		<div class="row">
			<div class="col-xs-12">
							<div class="input-group cpALL">
					<span class="input-group-addon sName">批量接口接口</span>
					<input type="text" class="form-control" onchange="javascript:return false;" placeholder="" value="" id="cALL">
					<span class="input-group-addon sLink" for="cALL"><a href="javascript:;" target="_blank"><span title="访问" class="glyphicon glyphicon-play-circle"></span>访问</a></span>
				</div>
				<div class="col-xs-12 line cpLine"></div>
								<h5 class="section cpFHdr" style="margin-top:15px;font-size:14px;color:#c33">高频类接口</h5>
									<div class="input-group cpSIN">
					<span class="input-group-addon sName" data-toggle="tooltip" data-html="true" data-placement="right"
					title="[11月28日缓存]<br/>
					182.92.151.236">
					景区数据接口</span>
					<input type="text" class="form-control sValue" placeholder="" value="" hdle="gd11x5" id="cgd11x5">
					<span class="expiries input-group-addon" title="至2015年12月18日00时 (3IPs)" inner="剩480小时 (3IPs)">剩480小时 (3IPs)</span>
					<span class="input-group-addon sLink" for="cgd11x5"><a href="javascript:;" target="_blank"><span title="访问" class="glyphicon glyphicon-play-circle"></span>访问</a></span>
				</div>
							<div class="input-group cpSIN">
					<span class="input-group-addon sName" data-toggle="tooltip" data-html="true" data-placement="right"
					title="[11月28日缓存]<br/>
					182.92.151.236">
					酒店数据接口</span>
					<input type="text" class="form-control sValue" placeholder="" value="" hdle="jx11x5" id="cjx11x5">
					<span class="expiries input-group-addon" title="至2015年12月18日00时 (3IPs)" inner="剩480小时 (3IPs)">剩480小时 (3IPs)</span>
					<span class="input-group-addon sLink" for="cjx11x5"><a href="javascript:;" target="_blank"><span title="访问" class="glyphicon glyphicon-play-circle"></span>访问</a></span>
				</div>
							<div class="input-group cpSIN">
					<span class="input-group-addon sName" data-toggle="tooltip" data-html="true" data-placement="right"
					title="[11月28日缓存]<br/>
					182.92.151.236">
					旅行社数据接口</span>
					<input type="text" class="form-control sValue" placeholder="" value="" hdle="sd11x5" id="csd11x5">
					<span class="expiries input-group-addon" title="至2015年12月18日00时 (3IPs)" inner="剩480小时 (3IPs)">剩480小时 (3IPs)</span>
					<span class="input-group-addon sLink" for="csd11x5"><a href="javascript:;" target="_blank"><span title="访问" class="glyphicon glyphicon-play-circle"></span>访问</a></span>
				</div>
							<div class="input-group cpSIN">
					<span class="input-group-addon sName" data-toggle="tooltip" data-html="true" data-placement="right"
					title="[11月28日缓存]<br/>
					182.92.151.236">
					导游数据接口</span>
					<input type="text" class="form-control sValue" placeholder="" value="" hdle="sh11x5" id="csh11x5">
					<span class="expiries input-group-addon" title="至2015年12月18日00时 (3IPs)" inner="剩480小时 (3IPs)">剩480小时 (3IPs)</span>
					<span class="input-group-addon sLink" for="csh11x5"><a href="javascript:;" target="_blank"><span title="访问" class="glyphicon glyphicon-play-circle"></span>访问</a></span>
				</div>
						</div>
		</div>
	</div>
	<h4 class="section"" style="border-style: solid none double none;border-width:2px">参数变量说明</h4>
	<div class="row">
		<div class="col-xs-12">
			<ul>
			<li>接口参数与数据都不区分大小写</li>
			<li>接口支持GET与POST两种提交方式</li>
			<li>接口中“方括号”为变量，访问时需要替换。如<span style="color:#f00">..date=[date]&..</span>替换为<span style="color:#f00">..date=2015-02-18&..</span></li>
			<li>接口不含“方括号”的参数即已经自动生成数据</li>
			</ul>
		</div>
		<div class="col-xs-12">
			<table class="table table-striped table-hover">
				<thead>
					<tr><th>变量</th><th>名称</th><th>说明</th></tr>
				</thead>
				<tbody>
					<tr><td>token</td><td>用户账号</td><td>必填，唯一标识。例：token=a1b2c3d4f5</td></tr>
					<tr><td>code</td><td>接口代码</td><td>部份接口格式支持逗号分割的多种接口。例：code=cqssc,cqklsf</td></tr>
					<tr><td>rows</td><td>返回行数</td><td>仅按最新查询时有效，默认5行。例：rows=3</td></tr>
					<tr><td>format</td><td>数据格式</td><td>支持xml与json格式，默认xml。例：format=json</td></tr>
					<tr><td>date</td><td>日期参数</td><td>仅按日期查询时有效，格式yyyy-MM-dd，低频返回当年。例：date=2015-02-18</td></tr>
					<!--<tr><td>phase</td><td>期号参数</td><td>仅按期号查询时有效，格式必须与接口对应。例：phase=2015021801</td></tr>-->
					<!--<tr><td>encoding</td><td>编码格式</td><td>接口数据仅默认采用utf-8格式</td></tr>-->
					<tr><td>callback</td><td>Jsonp回调函数</td><td>可选，为jsonp提供支持。例：callback=callback</td></tr>
					<!--<tr><td>jsonpcallback</td><td>Jsonp回调函数</td><td>等同于callback参数</td></tr>-->
				</tbody>
			</table>
		</div>
	</div>
	<div style="margin-top:60px;"></div>
</div>
<script type="text/javascript">	
	var token = "9e485d045eab4050";
	function builder(){
		var host = 'http://'+$("#ihost").attr("val")+'/';
		var face = $("#iface").attr("val");
		var fmt = $("#iformat").attr("val");
		var code = $("#icodes").attr("val");
		var dyn = $("#irewrite").attr("val");
		var rows = $("#irows").attr("val");
		
		if ((face=="newlyb" || face == "curlyb") && $("#cALL").length>0 && (code != '' && code.split(',').length <2)) {
			$("#cALL").val('批量接口请至少选择2种接口或者全部都不要选择！');
			$("#cALL").attr("disabled",true);
			$("#cALL").parent().find(".sLink a").attr("href",$("#cALL").val().substr(0,4) == "http" ? $("#cALL").val() : "javascript:;");
			$("#cALL").parent().find(".sLink a").attr("target",$("#cALL").val().substr(0,4) == "http" ? "_blank" : "_self");
			return;
		}
		else
			$("#cALL").attr("disabled",false);

		var url = host;
		if (face == "newlyb"){
			if (dyn == "file"){
				rows = rows == 1? "" : "-"+Math.min(rows,5);
				$("#cALL").val(url+token+"/index"+rows+"."+fmt);
			}
			else {
				code = code == "" ? "" : "&code="+code;
				rows = rows == 1? "" : "&rows="+Math.min(rows,5);
				fmt = fmt == "xml"? "" : "&format="+fmt;
				$("#cALL").val(url+"newly.do?token="+token+code+rows+fmt);
			}
		}
		else if (face == "curlyb"){
			fmt = fmt == "xml"? "" : "&format="+fmt;
			code = code == "" ? "" : "&code="+code;
			if (code == ''){
				$("#cALL").val(url+"curly.do?token="+token+fmt);
			}
			else{
				$("#cALL").val(url+"curly.do?token="+token+code+fmt);
			}
		}
		else
		{
			var rowsFix = rows == 5? "" : "-"+rows;
			var rowsDyn = rows == 5? "" : "&rows="+rows;
			var fmtDyn = fmt == "xml"? "" : "&format="+fmt;
			$(".sValue").each(function(){
				if (face == "newlys" && dyn == 'file') {
					code = $(this).attr("hdle");
					$(this).val(url+token+"/"+code+rowsFix+"."+fmt);
				}
				else {
					code = "&code="+$(this).attr("hdle");
					if (face == "newlys")
						$(this).val(url+"newly.do?token="+token+code+rowsDyn+fmtDyn);
					else if (face == "curlys")
						$(this).val(url+"curly.do?token="+token+code+fmtDyn);
					else if (face == "daily")
						$(this).val(url+"daily.do?token="+token+code+"&date="+new Date().addDays(-1).format('yyyy-MM-dd')+fmtDyn);
				}
				$(this).parent().find(".sLink a").attr("href",$(this).val().substr(0,4) == "http" ? $(this).val() : "javascript:;");
				$(this).parent().find(".sLink a").attr("target",$(this).val().substr(0,4) == "http" ? "_blank" : "_self");
			});
		}
		if ($("#cALL").length>0){
			$("#cALL").parent().find(".sLink a").attr("href",$("#cALL").val().substr(0,4) == "http" ? $("#cALL").val() : "javascript:;");
			$("#cALL").parent().find(".sLink a").attr("target",$("#cALL").val().substr(0,4) == "http" ? "_blank" : "_self");
		}
	}
	$(document).ready(function(){
		$("#ihost,#iface,#irewrite,#irows,#iformat").each(function(){
			var p = $(this);
			$(".btn",p).click(function(){
				$(".btn",p).removeClass("btn-primary").addClass("btn-default");
				$(this).addClass("btn-primary").removeClass("btn-default");
				p.attr("val",$(this).attr("val"));
				if (p.attr("id") == "iface") {
					var v = $(this).attr("val");
					$(".cpALL").css("display", ( v == "newlyb" || v == "curlyb") ? "" : "none");
					$(".cpLine").css("display",( v == "newlyb" || v == "curlyb") ? "" : "none");
					$(".cpFHdr").css("display",( v == "newlyb" || v == "curlyb") ? "none" : "");
					$(".cpSIN").css("display", ( v == "newlyb" || v == "curlyb") ? "none" : "");
					$("#irows").css("display", ( v == "newlys" || v == "newlyb") ? "" : "none");
					$("#irewrite").css("display", canFile() == true ? "" : "none");
					$("#icodes").css("display", (v == "newlyb" || v == "curlyb") ? "" : "none");					
					$("#irows .btn[val='"+(v == "newlyb" || v == "curlyb" ? "1" : "5")+"']").click();
					return;
				}
				if (p.attr("id") == "ihost") {
					var v = $(this).attr("val");
					$("input", p).attr("disabled", v.length > 1);
					$("input", p).focus();
					if (v.length < 2)
					$("input",p).keyup();
				}
				builder();
			});
			p.attr("val",$(".btn-primary",p).attr("val"));
		});

		$("#ihost input").keyup(function(){
			var v = $(this).val();
			$("#ihost").attr("val", v=='' ? 'vip' : v);
			builder();
		});
		$("#ihost .btn-primary").click();

		$("#icodes").each(function(){
			var p = $(this);
			$(".btn", p).click(function(){
				if ($(this).hasClass('btn-success'))
					$(this).addClass("btn-default").removeClass("btn-success");
				else
					$(this).addClass("btn-success").removeClass("btn-default");

				var v = "";
				if ($(".btn-default",p).length > 0 )
					$(".btn-success", p).each(function(){ v += ","+$(this).attr("val"); });
				p.attr("val",v.substr(1));
				$("#irewrite").css("display",canFile() ? "" : "none");
				builder();
			});
			var v = "";
			if ($(".btn-default",p).length > 0 )
				$(".btn-success", p).each(function(){ v += ","+$(this).attr("val"); });			
			p.attr("val",v.substr(1));			
		});

		$(".expiries").hover(function(){
			$(this).text($(this).attr('title'));
			$(this).css('color','#f00');
		}, function(){
			$(this).text($(this).attr('inner'));
			$(this).css('color','');
		});

		$(".uLinks .input-group").mouseover(function(){
		//	$("input",this).select();
		});
		$("#iface .btn[val='newlys']").click();
		builder();
	});
	function canFile(){
		var f = $("#iface").attr('val');
		if (f != 'newlys' && f != 'newlyb') return false;
		return f != 'newlyb' || $("#icodes").attr('val') == '';
	}
	$(function () { $('[data-toggle="tooltip"]').tooltip() });
</script>
</body>
</html>

